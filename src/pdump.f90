SUBROUTINE DUMP0
! DUMP GEOMETRY

   USE STRUCTURE
   USE GRADIENT
   USE CONSTANTS

   IMPLICIT NONE
   INTEGER :: I

   WRITE(6,'(A)') 'GEOMETRY IN UNITS OF BOHR'
   WRITE(6,'(A)') '--------------------------------------------------'
   WRITE(6,'(A)') ' ATOM         X              Y              Z     '
   DO I=1,NATOM
    WRITE(6,'(I3,A2,3F15.10)') I,CATOM(IATOM(I)),ATOMX(I),ATOMY(I),ATOMZ(I)
   ENDDO
   WRITE(6,'(A)')        '--------------------------------------------------'
   WRITE(6,'(A,3X,F15.10)') 'X TRANSLATIONAL PERIOD          ',PERIODX
   WRITE(6,'(A,3X,F15.10)') 'Y TRANSLATIONAL PERIOD          ',PERIODY
   WRITE(6,'(A,3X,F15.10)') 'Z TRANSLATIONAL PERIOD          ',PERIODZ
   WRITE(6,'(A)')        '--------------------------------------------------'
   IF (HELIX /= 0.0D0) THEN
    WRITE(6,'(A,3X,F15.10)') 'X HELICAL ANGLE                 ',HELIX  
    WRITE(6,'(A)')        '--------------------------------------------------'
   ENDIF
   RETURN
END SUBROUTINE



SUBROUTINE DUMP1(W,N,UX,UY,UZ)
! DUMP THE ELEMENTS OF A REAL MATRIX OF THE FORM W(N,N,-UX:UX,-UY:UY,-UZ:UZ)

   IMPLICIT NONE
   INTEGER :: N,UX,UY,UZ
   INTEGER :: I,JX,JY,JZ,K,L,M
   DOUBLE PRECISION :: W(N,N,-UX:UX,-UY:UY,-UZ:UZ)

   I=INT(FLOAT(N)/10.0)
   DO JX=-UX,UX
   DO JY=-UY,UY
   DO JZ=-UZ,UZ
    WRITE(6,'(A,3I3)') 'CELL :',JX,JY,JZ
    DO K=1,I
     WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
     DO L=1,N
      WRITE(6,'(I5,10F10.6)') L,(W(L,M,JX,JY,JZ),M=10*K-9,10*K)
     ENDDO
    ENDDO
    IF (N /= I*10) THEN
     WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
     DO L=1,N
      WRITE(6,'(I5,10F10.6:)') L,(W(L,M,JX,JY,JZ),M=10*I+1,N)
     ENDDO
    ENDIF
   ENDDO
   ENDDO
   ENDDO
   RETURN
END SUBROUTINE



SUBROUTINE DUMP2
! DUMP FORCES

   USE STRUCTURE
   USE GRADIENT
   USE CONSTANTS

   IMPLICIT NONE
   INTEGER :: I

   WRITE(6,'(A)') 'ENERGY GRADIENTS IN UNITS OF HARTREE/BOHR'
   WRITE(6,'(A)') '--------------------------------------------------'
   WRITE(6,'(A)') ' ATOM         X              Y              Z     '
   DO I=1,NATOM
    WRITE(6,'(I3,A2,3F15.10)') I,CATOM(IATOM(I)),FORCEX(I),FORCEY(I),FORCEZ(I)
   ENDDO
   IF (HELIX /= 0.0D0) THEN
    WRITE(6,'(A)')        '--------------------------------------------------'
    WRITE(6,'(A,3X,F15.10)') 'X TRANSLATIONAL ENERGY GRADIENT ',FORCETX
    WRITE(6,'(A,3X,F15.10)') 'X HELICAL ENERGY GRADIENT       ',FORCETA
    WRITE(6,'(A)')        '--------------------------------------------------'
   ELSE
    WRITE(6,'(A)')        '--------------------------------------------------'
    WRITE(6,'(A,3X,F15.10)') 'X TRANSLATIONAL ENERGY GRADIENT ',FORCETX
    WRITE(6,'(A,3X,F15.10)') 'Y TRANSLATIONAL ENERGY GRADIENT ',FORCETY
    WRITE(6,'(A,3X,F15.10)') 'Z TRANSLATIONAL ENERGY GRADIENT ',FORCETZ
    WRITE(6,'(A)')        '--------------------------------------------------'
   ENDIF
   RETURN
END SUBROUTINE



SUBROUTINE DUMP3(W,N,UX,UY,UZ,X,Y)
! DUMP THE ELEMENTS OF A REAL MATRIX OF THE FORM W(N,N,-UX:UX,-UY:UY,-UZ:UZ,Y)

   IMPLICIT NONE
   INTEGER :: N,UX,UY,UZ,X,Y
   INTEGER :: I,JX,JY,JZ,K,L,M
   DOUBLE PRECISION :: W(N,N,-UX:UX,-UY:UY,-UZ:UZ,Y)

   I=INT(FLOAT(N)/10.0)
   DO JX=0,UX
   DO JY=0,UY
   DO JZ=0,UZ
    WRITE(6,'(A,3I3)') 'CELL :',JX,JY,JZ
    DO K=1,I
     WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
     DO L=1,N
      WRITE(6,'(I5,10F10.6)') L,(W(L,M,JX,JY,JZ,X),M=10*K-9,10*K)
     ENDDO
    ENDDO
    IF (N /= I*10) THEN
     WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
     DO L=1,N
      WRITE(6,'(I5,10F10.6:)') L,(W(L,M,JX,JY,JZ,X),M=10*I+1,N)
     ENDDO
    ENDIF
   ENDDO
   ENDDO
   ENDDO
   RETURN
END SUBROUTINE



SUBROUTINE DUMP4
! DUMP THE ELEMENTS OF TWO-INDEX INTEGRALS FOR AUXILIARY GAUSSIANS

   USE INTEGRAL
   USE AUXILIARY
   USE CONTROL

   IMPLICIT NONE
   INTEGER :: I,J,K,L,M,QX,QY,QZ
   DOUBLE PRECISION,ALLOCATABLE :: W(:,:)


   WRITE(6,'(A)') 'TWO-INDEX TWO-ELECTRON INTEGRAL MATRIX FOR AUXILIARY GAUSSIANS'

   ALLOCATE(W(NAGS,NAGS))

   I=INT(FLOAT(NAGS)/10.0)
   DO QX=0,CEL1X
   DO QY=0,CEL1Y
   DO QZ=0,CEL1Z
!3  IF (LOPTN(30)) CALL TWOINDEX_V(W,NAGS,Q)
!3  IF (LOPTN(31)) CALL TWOINDEX_S(W,NAGS,Q)
    WRITE(6,'(A,3I3)') 'CELL :',QX,QY,QZ
    DO K=1,I
     WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
     DO L=1,NAGS
      WRITE(6,'(I5,10F10.6)') L,(W(L,M),M=10*K-9,10*K)
     ENDDO
    ENDDO
    IF (NAGS /= I*10) THEN
     WRITE(6,'(3X,10I10)') (L,L=10*I+1,NAGS)
     DO L=1,NAGS
      WRITE(6,'(I5,10F10.6:)') L,(W(L,M),M=10*I+1,NAGS)
     ENDDO
    ENDIF
   ENDDO
   ENDDO
   ENDDO

   DEALLOCATE(W)
   RETURN
END SUBROUTINE



SUBROUTINE DUMP5(W,N)
! DUMP THE ELEMENTS OF A REAL MATRIX OF THE FORM W(N,N)

   IMPLICIT NONE
   INTEGER :: N
   INTEGER :: I,K,L,M
   DOUBLE PRECISION :: W(N,N)

   I=INT(FLOAT(N)/10.0)
   DO K=1,I
    WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
    DO L=1,N
     WRITE(6,'(I5,10F10.6)') L,(W(L,M),M=10*K-9,10*K)
!    WRITE(6,'(I5,10E10.3)') L,(W(L,M),M=10*K-9,10*K)
    ENDDO
   ENDDO
   IF (N /= I*10) THEN
    WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
    DO L=1,N
     WRITE(6,'(I5,10F10.6:)') L,(W(L,M),M=10*I+1,N)
!    WRITE(6,'(I5,10E10.3:)') L,(W(L,M),M=10*I+1,N)
    ENDDO
   ENDIF

   RETURN
END SUBROUTINE



SUBROUTINE DUMP6(IUNIT,N,M)
! DUMP THE ELEMENTS OF A REAL SQUARE MATRIX OF DIMENSION N STORED IN FILE (UNIT = IUNIT).
! N X M ARRAY MUST HAVE BEEN USED TO WRITE THE FILE.

   IMPLICIT NONE
   INTEGER :: IUNIT,N,M
   INTEGER :: I,J,K,L,H,IM
   DOUBLE PRECISION,ALLOCATABLE :: V(:,:),W(:,:)

   ALLOCATE(V(N,M),W(N,N))

   IF (MOD(N,M) /= 0) CALL PABORT('AN INTERNAL PROGRAM ERROR IS DETECTED')

   REWIND(IUNIT)
   DO I=1,N
    IM=MOD(I,M)
    IF (IM == 0) IM=M
    IF (IM == 1) READ(IUNIT) V
    DO J=1,N
     W(I,J)=V(J,IM)
    ENDDO
   ENDDO

   I=INT(FLOAT(N)/10.0)
   DO K=1,I
    WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
    DO L=1,N
     WRITE(6,'(I5,10F10.6)') L,(W(L,H),H=10*K-9,10*K)
    ENDDO
   ENDDO
   IF (N /= I*10) THEN
    WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
    DO L=1,N
     WRITE(6,'(I5,10F10.6:)') L,(W(L,H),H=10*I+1,N)
    ENDDO
   ENDIF

   DEALLOCATE(V,W)

   RETURN
END SUBROUTINE



SUBROUTINE DUMP7(W,N)
! DUMP THE ELEMENTS OF A COMPLEX MATRIX OF THE FORM W(N,N)

   IMPLICIT NONE
   INTEGER :: N
   INTEGER :: I,K,L,M
   DOUBLE COMPLEX :: W(N,N)

   WRITE(6,'(A)') 'REAL PART'
   I=INT(FLOAT(N)/10.0)
   DO K=1,I
    WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
    DO L=1,N
     WRITE(6,'(I5,10F10.6)') L,(DREAL(W(L,M)),M=10*K-9,10*K)
    ENDDO
   ENDDO
   IF (N /= I*10) THEN
    WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
    DO L=1,N
     WRITE(6,'(I5,10F10.6:)') L,(DREAL(W(L,M)),M=10*I+1,N)
    ENDDO
   ENDIF

   WRITE(6,'(A)') 'IMAGINARY PART'
   I=INT(FLOAT(N)/10.0)
   DO K=1,I
    WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
    DO L=1,N
     WRITE(6,'(I5,10F10.6)') L,(DIMAG(W(L,M)),M=10*K-9,10*K)
    ENDDO
   ENDDO
   IF (N /= I*10) THEN
    WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
    DO L=1,N
     WRITE(6,'(I5,10F10.6:)') L,(DIMAG(W(L,M)),M=10*I+1,N)
    ENDDO
   ENDIF

   RETURN
END SUBROUTINE



SUBROUTINE DUMP8(W,N,U)
! DUMP THE ELEMENTS OF A TRIAL VECTOR W(N,-U:U)

   IMPLICIT NONE
   INTEGER :: N,U
   INTEGER :: I,L,M
   DOUBLE COMPLEX :: W(N,-U:U)
   DOUBLE PRECISION :: A

   A=0.0D0
   DO M=-U,MAX(0,U-1)
    DO L=1,N
     A=A+DREAL(W(L,M))**2
    ENDDO
   ENDDO
   IF (A == 0.0D0) THEN
    WRITE(6,'(A)') 'REAL PART      ... IS ZERO'
   ELSE
    WRITE(6,'(A)') 'REAL PART'
    WRITE(6,'(3X,99I7)') (L,L=-U,MAX(0,U-1))
    DO L=1,N
     WRITE(6,'(I5,99F7.4:)') L,(DREAL(W(L,M)),M=-U,MAX(0,U-1))
    ENDDO
   ENDIF

   A=0.0D0
   DO M=-U,MAX(0,U-1)
    DO L=1,N
     A=A+DIMAG(W(L,M))**2
    ENDDO
   ENDDO
   IF (A == 0.0D0) THEN
    WRITE(6,'(A)') 'IMAGINARY PART ... IS ZERO'
   ELSE
    WRITE(6,'(A)') 'IMAGINARY PART'
    WRITE(6,'(3X,99I7)') (L,L=-U,MAX(0,U-1))
    DO L=1,N
     WRITE(6,'(I5,99F7.4:)') L,(DIMAG(W(L,M)),M=-U,MAX(0,U-1))
    ENDDO
   ENDIF

   RETURN
END SUBROUTINE



SUBROUTINE DUMP9(W,N,U)
! DUMP THE ELEMENTS OF A COMPLEX MATRIX OF THE FORM W(N,N,-U:U)

   IMPLICIT NONE
   INTEGER :: N,U
   INTEGER :: I,J,K,L,M
   DOUBLE COMPLEX :: W(N,N,-U:U)
   DOUBLE PRECISION :: A

   I=INT(FLOAT(N)/10.0)

   A=0.0D0
   DO J=-U,U
    DO K=1,N
     DO L=1,N
      A=A+DREAL(W(L,K,J))**2
     ENDDO
    ENDDO
   ENDDO
   IF (A == 0.0D0) THEN
    WRITE(6,'(A)') 'REAL PART      ... IS ZERO'
   ELSE
    WRITE(6,'(A)') 'REAL PART'
    DO J=-U,U
     WRITE(6,'(A,I3)') 'CELL :',J
     DO K=1,I
      WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
      DO L=1,N
       WRITE(6,'(I5,10F10.6)') L,(DREAL(W(L,M,J)),M=10*K-9,10*K)
      ENDDO
     ENDDO
     IF (N /= I*10) THEN
      WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
      DO L=1,N
       WRITE(6,'(I5,10F10.6:)') L,(DREAL(W(L,M,J)),M=10*I+1,N)
      ENDDO
     ENDIF
    ENDDO
   ENDIF

   A=0.0D0
   DO J=-U,U
    DO K=1,N
     DO L=1,N
      A=A+DIMAG(W(L,K,J))**2
     ENDDO
    ENDDO
   ENDDO
   IF (A == 0.0D0) THEN
    WRITE(6,'(A)') 'IMAGINARY PART ... IS ZERO'
   ELSE
    WRITE(6,'(A)') 'IMAGINARY PART'
    DO J=-U,U
     WRITE(6,'(A,I3)') 'CELL :',J
     DO K=1,I
      WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
      DO L=1,N
       WRITE(6,'(I5,10F10.6)') L,(DIMAG(W(L,M,J)),M=10*K-9,10*K)
      ENDDO
     ENDDO
     IF (N /= I*10) THEN
      WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
      DO L=1,N
       WRITE(6,'(I5,10F10.6:)') L,(DIMAG(W(L,M,J)),M=10*I+1,N)
      ENDDO
     ENDIF
    ENDDO
   ENDIF

   RETURN
END SUBROUTINE



SUBROUTINE DUMP10(W,N,NP)
! DUMP THE ELEMENTS OF A REAL MATRIX OF THE FORM W(N,N) WITH PHYSICAL DIMENSION W(NP,NP)

   IMPLICIT NONE
   INTEGER :: N,NP
   INTEGER :: I,K,L,M
   DOUBLE PRECISION :: W(NP,NP)

   I=INT(FLOAT(N)/10.0)
   DO K=1,I
    WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
    DO L=1,N
     WRITE(6,'(I5,10F10.6)') L,(W(L,M),M=10*K-9,10*K)
    ENDDO
   ENDDO
   IF (N /= I*10) THEN
    WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
    DO L=1,N
     WRITE(6,'(I5,10F10.6:)') L,(W(L,M),M=10*I+1,N)
    ENDDO
   ENDIF

   RETURN
END SUBROUTINE



SUBROUTINE DUMP11(W,N,NP)
! DUMP THE ELEMENTS OF A COMPLEX MATRIX OF THE FORM W(N,N) WITH PHYSICAL DIMENSION W(NP,NP)

   IMPLICIT NONE
   INTEGER :: N,NP
   INTEGER :: I,K,L,M
   DOUBLE COMPLEX :: W(NP,NP)
   DOUBLE PRECISION :: A

   A=0.0D0
   DO K=1,N
    DO L=1,N
     A=A+DREAL(W(L,K))**2
    ENDDO
   ENDDO
   IF (A == 0.0D0) THEN
    WRITE(6,'(A)') 'REAL PART ... IS ZERO'
   ELSE
    WRITE(6,'(A)') 'REAL PART'
    I=INT(FLOAT(N)/10.0)
    DO K=1,I
     WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
     DO L=1,N
      WRITE(6,'(I5,10F10.6)') L,(DREAL(W(L,M)),M=10*K-9,10*K)
     ENDDO
    ENDDO
    IF (N /= I*10) THEN
     WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
     DO L=1,N
      WRITE(6,'(I5,10F10.6:)') L,(DREAL(W(L,M)),M=10*I+1,N)
     ENDDO
    ENDIF
   ENDIF

   A=0.0D0
   DO K=1,N
    DO L=1,N
     A=A+DIMAG(W(L,K))**2
    ENDDO
   ENDDO
   IF (A == 0.0D0) THEN
    WRITE(6,'(A)') 'IMAGINARY PART ... IS ZERO'
   ELSE
    WRITE(6,'(A)') 'IMAGINARY PART'
    I=INT(FLOAT(N)/10.0)
    DO K=1,I
     WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
     DO L=1,N
      WRITE(6,'(I5,10F10.6)') L,(DIMAG(W(L,M)),M=10*K-9,10*K)
     ENDDO
    ENDDO
    IF (N /= I*10) THEN
     WRITE(6,'(3X,10I10)') (L,L=10*I+1,N)
     DO L=1,N
      WRITE(6,'(I5,10F10.6:)') L,(DIMAG(W(L,M)),M=10*I+1,N)
     ENDDO
    ENDIF
   ENDIF

   RETURN
END SUBROUTINE



SUBROUTINE DUMP12(R)
! DUMP RADIAL FUNCTIONS FOR L AND M ANGULAR MOMENTUM QUANTUM NUMBERS

   USE SINANOGLU

   IMPLICIT NONE
   INTEGER :: L,M
   DOUBLE COMPLEX :: R(0:LMAX,-LMAX:LMAX,RG)
   INTEGER :: I

   WRITE(6,'(A)') 'REAL PART'
   DO L=0,LMAX
    WRITE(6,'(A,I3)') ' L =',L
    DO I=1,RG
     WRITE(6,'(15F9.3:)') (DREAL(R(L,M,I)),M=-L,L) 
    ENDDO
   ENDDO

   WRITE(6,'(A)') 'IMAGINARY PART'
   DO L=0,LMAX
    WRITE(6,'(A,I3)') ' L =',L
    DO I=1,RG
     WRITE(6,'(15F9.3:)') (DIMAG(R(L,M,I)),M=-L,L) 
    ENDDO
   ENDDO

   RETURN
END SUBROUTINE



SUBROUTINE DUMP13(NR,PAIR,IG,IFILE,PLANE)
! DUMP FUNCTIONS ON A RADIAL-ANGULAR GRID

   USE DFT

   IMPLICIT NONE
   INTEGER :: NR
   INTEGER :: IG
   INTEGER :: IFILE
   DOUBLE PRECISION :: PAIR(NR,*)
   CHARACTER*2 :: PLANE
   INTEGER :: I

   REWIND(IFILE)
   DO I=1,NR
    IF ((PLANE=='XY').AND.(GRIDZ(I,1)==0.0D0)) WRITE(IFILE,'(3F25.10)') GRIDX(I,1),GRIDY(I,1),PAIR(I,IG)
    IF ((PLANE=='YZ').AND.(GRIDX(I,1)==0.0D0)) WRITE(IFILE,'(3F25.10)') GRIDY(I,1),GRIDZ(I,1),PAIR(I,IG)
    IF ((PLANE=='ZX').AND.(GRIDY(I,1)==0.0D0)) WRITE(IFILE,'(3F25.10)') GRIDZ(I,1),GRIDX(I,1),PAIR(I,IG)
   ENDDO
   RETURN
END SUBROUTINE
 


SUBROUTINE DUMP14(INFILE,STATE)
! DUMP CI VECTORS. STATE=0 (NEUTRAL), 1 (CATION), -1 (ANION).

   USE FULLCI

   IMPLICIT NONE
   INTEGER :: INFILE,STATE
   INTEGER :: IA,IB,IRANGE
   DOUBLE PRECISION,ALLOCATABLE :: TRL(:,:)

   IF (STATE==0) THEN
    WRITE(6,'(A,I3)') 'NEUTRAL FILE:',INFILE
    ALLOCATE(TRL(NCF,NCF))
    IRANGE=NCF
   ELSE IF (STATE==1) THEN
    WRITE(6,'(A,I3)') 'CATION FILE:',INFILE
    ALLOCATE(TRL(IP_NCF,NCF))
    IRANGE=IP_NCF
   ELSE IF (STATE==-1) THEN
    WRITE(6,'(A,I3)') 'ANION FILE:',INFILE
    ALLOCATE(TRL(EA_NCF,NCF))
    IRANGE=EA_NCF
   ENDIF
   REWIND(INFILE)
   READ(INFILE) TRL
   DO IB=1,NCF
    DO IA=1,IRANGE
     WRITE(6,'(2I3,F20.15)') IB,IA,TRL(IA,IB)
    ENDDO
   ENDDO
   DEALLOCATE(TRL)
   RETURN
END SUBROUTINE



SUBROUTINE DUMP15(W,N,UX,UY,UZ,IFILE)
! DUMP THE ELEMENTS OF A REAL MATRIX OF THE FORM W(N,N,-UX:UX,-UY:UY,-UZ:UZ)

   IMPLICIT NONE
   INTEGER :: IFILE
   INTEGER :: N,UX,UY,UZ
   INTEGER :: I,JX,JY,JZ,K,L,M
   DOUBLE PRECISION :: W(N,N,-UX:UX,-UY:UY,-UZ:UZ)

   I=INT(FLOAT(N)/10.0)
   DO JX=0,UX
   DO JY=0,UY
   DO JZ=0,UZ
    WRITE(IFILE,'(A,3I3)') 'CELL :',JX,JY,JZ
    DO K=1,I
     WRITE(IFILE,'(3X,10I10)') (L,L=10*K-9,10*K)
     DO L=1,N
      WRITE(IFILE,'(I5,10F10.6)') L,(W(L,M,JX,JY,JZ),M=10*K-9,10*K)
     ENDDO
    ENDDO
    IF (N /= I*10) THEN
     WRITE(IFILE,'(3X,10I10)') (L,L=10*I+1,N)
     DO L=1,N
      WRITE(IFILE,'(I5,10F10.6:)') L,(W(L,M,JX,JY,JZ),M=10*I+1,N)
     ENDDO
    ENDIF
   ENDDO
   ENDDO
   ENDDO
   RETURN
END SUBROUTINE



SUBROUTINE DUMP16(W,N1,N2)
! DUMP THE ELEMENTS OF A REAL MATRIX OF THE FORM W(N1,N2)

   IMPLICIT NONE
   INTEGER :: N1,N2
   INTEGER :: I,K,L,M
   DOUBLE PRECISION :: W(N1,N2)

   I=INT(FLOAT(N2)/10.0)
   DO K=1,I
    WRITE(6,'(3X,10I10)') (L,L=10*K-9,10*K)
    DO L=1,N1
     WRITE(6,'(I5,10F10.6)') L,(W(L,M),M=10*K-9,10*K)
!    WRITE(6,'(I5,10E10.3)') L,(W(L,M),M=10*K-9,10*K)
    ENDDO
   ENDDO
   IF (N2 /= I*10) THEN
    WRITE(6,'(3X,10I10)') (L,L=10*I+1,N2)
    DO L=1,N1
     WRITE(6,'(I5,10F10.6:)') L,(W(L,M),M=10*I+1,N2)
!    WRITE(6,'(I5,10E10.3:)') L,(W(L,M),M=10*I+1,N2)
    ENDDO
   ENDIF

   RETURN
END SUBROUTINE



SUBROUTINE DUMP17(W,N)
! DUMP THE ELEMENTS OF AN INTEGER MATRIX OF THE FORM W(N,N)
   
   IMPLICIT NONE
   INTEGER :: N
   INTEGER :: I,K,L,M
   INTEGER :: W(N,N)
   
   I=INT(FLOAT(N)/10.0)
   DO K=1,I
!   WRITE(6,'(3X,10I6)') (L,L=10*K-9,10*K)
    DO L=1,N
!    WRITE(6,'(I5,10I6)') L,(W(L,M),M=10*K-9,10*K)
     WRITE(6,'(5X,10I6)') (W(L,M),M=10*K-9,10*K)
    ENDDO
   ENDDO
   IF (N /= I*10) THEN
!   WRITE(6,'(3X,10I6)') (L,L=10*I+1,N)
    DO L=1,N 
     WRITE(6,'(5X,10I6:)') (W(L,M),M=10*I+1,N)
    ENDDO
   ENDIF
    
   RETURN
END SUBROUTINE

